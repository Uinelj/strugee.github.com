<!DOCTYPE html><!--Â© Copyright 2012, 2013, 2014 Alex Jordan
This file is part of strugee.net.
strugee.net is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
strugee.net is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with strugee.net.	If not, see <http://www.gnu.org/licenses/>.
--><!-- Made and coded by Alex Jordan--><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/bootstrap-responsive.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><!-- IE7 support isn't really needed, but this addition is so easy I might as well --><!--[if lte IE 7]> <link rel="stylesheet" href="/css/font-awesome-ie7.min.css"> <![endif]--><link rel="stylesheet" href="/css/main.css"><!--[if gte IE 8]> <link rel="stylesheet" href="/css/ie9.css"> <![endif]--><!-- IndieWeb components, with <3--><link rel="me" href="mailto:alex@strugee.net"><link rel="me" href="sms:17607054581"><link rel="me" href="https://github.com/strugee"><link rel="me" href="https://twitter.com/strugee2"><link rel="me" href="https://plus.google.com/+AlexJordan"><link rel="me" href="https://pump.strugee.net/alex"><link rel="me" href="https://pod.strugee.net/people/82e1c9a030600133e0ca20474782d58c"><title>Stratic part one is done! - strugee.net</title></head><body><div id="container"><!--[if lt IE 7]><p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.<![endif]--><header><h1 id="topheader">strugee.net</h1><nav id="navbar"><ul><li id="navlabel" class="navlink">Nav ::</li><li class="navlink"><a href="/index">Home</a></li><li class="navlink"><a href="/services">Services</a></li><li class="navlink"><a href="/projects">Projects</a></li><li class="navlink"><a href="/gpg">GPG Key</a></li><li class="navlink"><a href="http://ramblingsfromalex.blogspot.com">Blog</a></li></ul></nav></header><article><h1>Stratic part one is done! (published by Alex Jordan)</h1><p>Whooooooooooo!</p>
<p>I am so, so, <em>so</em> thrilled to announce that the first part of <a href="https://github.com/strugee/generator-stratic">Stratic</a> is complete! And you can see the result right here on strugee.net, since this blog post was generated with Stratic!</p>
<p><strong>tl;dr</strong>:</p>
<pre><code>var rename = require(&#39;gulp-rename&#39;);
var markdown = require(&#39;gulp-markdown&#39;);
var parse = require(&#39;stratic-parse-header&#39;);
var straticToJson = require(&#39;stratic-post-to-json-data&#39;);
var jadeTemplate = require(&#39;gulp-jade-template&#39;);
var dateInPath = require(&#39;stratic-date-in-path&#39;);

gulp.task(&#39;posts&#39;, function() {
    return gulp.src(&#39;src/blog/*.md&#39;)
               .pipe(parse())
               .pipe(markdown())
               .pipe(dateInPath())
               .pipe(straticToJson())
               .pipe(jadeTemplate(&#39;src/blog/post.jade&#39;))
               .pipe(rename({ extname: &#39;.html&#39; }))
               .pipe(gulp.dest(&#39;dist/blog&#39;));
});
</code></pre><p>How <em>gorgeous</em> is that?? Let me explain how it works. (I&#39;ll assume the reader is familiar with <a href="https://github.com/gulpjs/gulp">Gulp</a> and <a href="https://nodejs.org/en/">Node.js</a>.)</p>
<p>So the <code>gulp.src()</code> call is pretty obvious. We just read all the blog posts into the stream. Note, however, that <code>gulp.src()</code> doesn&#39;t stream text, per se - it streams <a href="https://github.com/gulpjs/vinyl">Vinyl</a> file objects. This will become important later.</p>
<p>Now, the first piece of custom Stratic code that we use is the <code>stratic-parse-header</code> module. This module takes a Markdown file with a standard Stratic header (see <a href="https://strugee.net/blog/2014/11/new-blog-new-site">my original announcement</a> for details), parses the header, strips it out, then returns the new, headerless Markdown. However, the new Vinyl file object has a couple of new properties from the parsing phase - specifically, <code>file.title</code>, <code>file.author</code>, <code>file.time</code>, and <code>file.categories</code> now exist. This is why the fact that Vinyl is used is important - now <em>any</em> Gulp plugin downstream from where <code>parse()</code> is run can use all of these values in whatever way it wants. (See <a href="https://github.com/strugee/stratic-parse-header/blob/master/README.md">the README</a> for more details.)</p>
<p>Now our Vinyl file object is <em>only</em> the content of the post, and it has additional Stratic metadata attached to it. Awesome! The next thing that we do is render the Markdown, just using a standard Gulp plugin for this. Easy breezy. After that, we pipe to the <code>stratic-date-in-path</code> module, which adds the year and month to paths. For example, without <code>stratic-date-in-path</code>, this blog post would be at <code>https://strugee.net/blog/stratic-part-one</code>. However, since I <em>do</em> use <code>stratic-date-in-path</code>, the post lives at <code>https://strugee.net/blog/2016/05/stratic-part-one</code> instead. Nice, right? Eventually I&#39;ll write code to generate pretty indexes for each year and month - that&#39;s what Stratic part 2 is for.</p>
<p>The next thing we do is pipe to the <code>stratic-post-to-json-data</code> module. This module is specifically designed to work with the <code>gulp-jade-template</code> module, which expects the file contents to be some JSON that will be given as data to a <a href="http://jade-lang.com/">Jade</a> template, whose rendered HTML becomes the new file contents. What sets up that JSON? You guessed it - <code>stratic-post-to-json-data</code>. That&#39;s all it does. It just creates an object that contains the metadata and the actual post text, runs it through <code>JSON.stringify()</code>, and sets the file contents equal to the result. Just how <code>gulp-jade-template</code> likes it.</p>
<p>And with that, we&#39;ve successfully rendered a blog post. Whooooooooooo! I&#39;m so pumped about this software. The call to <code>rename()</code> is just a little housekeeping, and then we write the whole thing back to disk with <code>gulp.dest()</code>. Awesome.</p>
<p>It&#39;s worth noting that the real beauty in this code isn&#39;t what the code actually does, but the extreme modularity of the whole thing. Unlike projects like <a href="https://jekyllrb.com/">Jekyll</a> or even <a href="http://wintersmith.io/">Wintersmith</a>, this isn&#39;t a giant, monolithic framework. It&#39;s all standard Node and Gulp. Note how (for example) we didn&#39;t need a custom plugin for Markdown - we just used the standard <code>gulp-markdown</code>. Don&#39;t like Markdown? No problem. Write something to extract post metadata from your preferred format, replace <code>parse()</code> with that and <code>markdown()</code> with a different renderer, and you&#39;re golden. All the rest will continue to work the <em>exact</em> same - adding dates to paths, rendering the template, etc. - because everything&#39;s decoupled from everything else. Each component can be trivially swapped out and replaced with something new and better, and the rest of the system continues to work. Gorgeous.</p>
<p>I&#39;ve got to go now, but I&#39;m not done blogging. I&#39;ll be back soon to talk about the work going on in <a href="http://pump.io/">Pump.io</a>, and I&#39;ll be back (much?) later to talk about Stratic part two (aka, pretty indexes).</p>
<p>Whooooooooooooooooooooo!</p>
</article><footer><p>You may find the source code for this website, licensed to you under the GNU Affero GPL, <a href="https://github.com/strugee/strugee.github.com">on GitHub</a>.</p><p>&copy; Copyright 2012-2016 Alex Jordan.</p></footer><!-- Piwik--><!-- Note that this Piwik instance is self-hosted and so doesn't leak metadata. Also, critically, it respects Do Not Track.--><script type="text/javascript">var _paq = _paq || [];
_paq.push(['trackPageView']);
_paq.push(['enableLinkTracking']);
(function() {
var u="//piwik.strugee.net/";
_paq.push(['setTrackerUrl', u+'piwik.php']);
_paq.push(['setSiteId', 1]);
var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
})();</script><noscript><p><img src="//piwik.strugee.net/piwik.php?idsite=1" style="border:0;" alt=""></p></noscript><!-- End Piwik Code--><div id="toys"><a id="lightbulb-icon" href="#"><div class="icon-lightbulb"></div></a></div><script type="text/javascript" src="/js/main.js"></script><script type="text/javascript" src="/js/idl.js"></script></div></body></html>